from tape import TAPETokenizer, ProteinBertModel
import re
import torch
import random
            
AALETTER = [
    "A",
    "R",
    "N",
    "D",
    "C",
    "Q",
    "E",
    "G",
    "H",
    "I",
    "L",
    "K",
    "M",
    "F",
    "P",
    "S",
    "T",
    "W",
    "Y",
    "V",
]

# add 'X/U/O*' to the list as unknown or missing amminoacid
# reference: https://wiki.thegpm.org/wiki/Amino_acid_symbols
AALETTER_REGEX = "^[" + "".join(AALETTER) + "XUO*" + "]*$"

def strip_sequence(seq):
    seqs = seq.strip().split("\n")
    ret = ""
    for s in seqs:
        if not s.startswith(">"):
            ret += s
    return ret

def extract_sequence(seq):
    if "\n" in seq:
        seq = strip_sequence(seq)
        if not re.match(AALETTER_REGEX, seq):
            raise ValueError("Protein sequence contains invalid letter(s):" + seq)
    return seq


bert_model = None
tokenizer = TAPETokenizer(vocab="iupac")
BERT_FEATURE_LENGTH = 768

def encode_sequence_bert(sequence, device="cpu", max_length=8192):
    global bert_model
    if not bert_model:
        bert_model = ProteinBertModel.from_pretrained("bert-base")
        bert_model.eval()
        bert_model.to(device)
    # tokenizer = TAPETokenizer(vocab="unirep")
    assert len(sequence) > 0
    protein_sequence = extract_sequence(sequence) # length: 932
    vec = tokenizer.encode(protein_sequence) # length: 934
    protein_vector = torch.tensor(vec[None, :])[:, 1:-1][:, :max_length] # Limit the length to 8192
    assert protein_vector.size()[1] > 0, f"invalid sequence: {sequence}"
    protein_vector = protein_vector.to(device) # length (1, 932)
    with torch.no_grad():
        local_embedding, global_embedding = bert_model(protein_vector) # torch.Size([1, 932, 768]), torch.Size([1, 768])
    return local_embedding[0], global_embedding[0]


if __name__ == "__main__":
    # sequence = '>sp|Q9Y5G6|PCDG7_HUMAN Protocadherin gamma-A7 OS=Homo sapiens OX=9606 GN=PCDHGA7 PE=2 SV=1\nMAAQPRGGDYRGFFLLSILLGTPWEAWAGRILYSVSEETDKGSFVGDIAKDLGLEPRELA\nERGVRIISRGRTQLFALNQRSGSLVTAGRIDREEICAQSARCLVNFNILMEDKMNLYPID\nVEIIDINDNVPRFLTEEINVKIMENTAPGVRFPLSEAGDPDVGTNSLQSYQLSPNRHFSL\nAVQSGDDETKYPELVLERVLDREEERVHHLVLTASDGGDPPRSSTAHIQVTVVDVNDHTP\nVFSLPQYQVTVPENVPVGTRLLTVHAIDLDEGVNGEVTYSFRKITPKLPKMFHLNSLTGE\nISTLEGLDYEETAFYEMEVQAQDGPGSLTKAKVLITVLDVNDNAPEVTMTSLSSSIPEDT\nPLGTVIALFYLQDRDSGKNGEVTCTIPENLPFKLEKSIDNYYRLVTTKNLDRETLSLYNI\nTLKATDGGTPPLSRETHIFMQVADTNDNPPTFPHSSYSVYIAENNPRGASIFLVTAQDHD\nSEDNAQITYSLAEDTIQGAPVSSYVSINSDTGVLYALQSFDYEQLRELQLRVTAHDSGDP\nPLSSNMSLSLFVLDQNDNPPEILYPALPTDGSTGMELAPRSAEPGYLVTKVVAVDKDSGQ\nNAWLSYLLLKASEPGLFAVGLYTGEVRTARALLDRDALKQSLVVAVQDHGQPPLSATVTL\nTVAVADSIPEVLADLGSLEPSDGPYNYDLTLYLVVAVATVSCVFLAFVLVLLALRLRRWH\nKSRLLQASEGGLANVPTSHFVGMDGVQAFLQTYSHEVSLTADSRKSHLIFPQPNYVDMLI\nSQESCEKNDSLLTSVDFQECKENLPSIQQAPPNTDWRFSQAQRPGTSGSQNGDDTGTWPN\nNQFDTEMLQAMILASASEAADGSSTLGGGAGTMGLSARYGPQFTLQHVPDYRQNVYIPGS\nNATLTNAAGKRDGKAPAGGNGNKKKSGKKEKK\n'
    sequence = '>sp|Q8WXI7|MUC16_HUMAN Mucin-16 OS=Homo sapiens OX=9606 GN=MUC16 PE=1 SV=3\nMLKPSGLPGSSSPTRSLMTGSRSTKATPEMDSGLTGATLSPKTSTGAIVVTEHTLPFTSP\nDKTLASPTSSVVGRTTQSLGVMSSALPESTSRGMTHSEQRTSPSLSPQVNGTPSRNYPAT\nSMVSGLSSPRTRTSSTEGNFTKEASTYTLTVETTSGPVTEKYTVPTETSTTEGDSTETPW\nDTRYIPVKITSPMKTFADSTASKENAPVSMTPAETTVTDSHTPGRTNPSFGTLYSSFLDL\nSPKGTPNSRGETSLELILSTTGYPFSSPEPGSAGHSRISTSAPLSSSASVLDNKISETSI\nFSGQSLTSPLSPGVPEARASTMPNSAIPFSMTLSNAETSAERVRSTISSLGTPSISTKQT\nAETILTFHAFAETMDIPSTHIAKTLASEWLGSPGTLGGTSTSALTTTSPSTTLVSEETNT\nHHSTSGKETEGTLNTSMTPLETSAPGEESEMTATLVPTLGFTTLDSKIRSPSQVSSSHPT\nRELRTTGSTSGRQSSSTAAHGSSDILRATTSSTSKASSWTSESTAQQFSEPQHTQWVETS\nPSMKTERPPASTSVAAPITTSVPSVVSGFTTLKTSSTKGIWLEETSADTLIGESTAGPTT\nHQFAVPTGISMTGGSSTRGSQGTTHLLTRATASSETSADLTLATNGVPVSVSPAVSKTAA\nGSSPPGGTKPSYTMVSSVIPETSSLQSSAFREGTSLGLTPLNTRHPFSSPEPDSAGHTKI\nSTSIPLLSSASVLEDKVSATSTFSHHKATSSITTGTPEISTKTKPSSAVLSSMTLSNAAT\nSPERVRNATSPLTHPSPSGEETAGSVLTLSTSAETTDSPNIHPTGTLTSESSESPSTLSL\nPSVSGVKTTFSSSTPSTHLFTSGEETEETSNPSVSQPETSVSRVRTTLASTSVPTPVFPT\nMDTWPTRSAQFSSSHLVSELRATSSTSVTNSTGSALPKISHLTGTATMSQTNRDTFNDSA\nAPQSTTWPETSPRFKTGLPSATTTVSTSATSLSATVMVSKFTSPATSSMEATSIREPSTT\nILTTETTNGPGSMAVASTNIPIGKGYITEGRLDTSHLPIGTTASSETSMDFTMAKESVSM\nSVSPSQSMDAAGSSTPGRTSQFVDTFSDDVYHLTSREITIPRDGTSSALTPQMTATHPPS\nPDPGSARSTWLGILSSSPSSPTPKVTMSSTFSTQRVTTSMIMDTVETSRWNMPNLPSTTS\nLTPSNIPTSGAIGKSTLVPLDTPSPATSLEASEGGLPTLSTYPESTNTPSIHLGAHASSE\nSPSTIKLTMASVVKPGSYTPLTFPSIETHIHVSTARMAYSSGSSPEMTAPGETNTGSTWD\nPTTYITTTDPKDTSSAQVSTPHSVRTLRTTENHPKTESATPAAYSGSPKISSSPNLTSPA\nTKAWTITDTTEHSTQLHYTKLAEKSSGFETQSAPGPVSVVIPTSPTIGSSTLELTSDVPG\nEPLVLAPSEQTTITLPMATWLSTSLTEEMASTDLDISSPSSPMSTFAIFPPMSTPSHELS\nKSEADTSAIRNTDSTTLDQHLGIRSLGRTGDLTTVPITPLTTTWTSVIEHSTQAQDTLSA\nTMSPTHVTQSLKDQTSIPASASPSHLTEVYPELGTQGRSSSEATTFWKPSTDTLSREIET\nGPTNIQSTPPMDNTTTGSSSSGVTLGIAHLPIGTSSPAETSTNMALERRSSTATVSMAGT\nMGLLVTSAPGRSISQSLGRVSSVLSESTTEGVTDSSKGSSPRLNTQGNTALSSSLEPSYA\nEGSQMSTSIPLTSSPTTPDVEFIGGSTFWTKEVTTVMTSDISKSSARTESSSATLMSTAL\nGSTENTGKEKLRTASMDLPSPTPSMEVTPWISLTLSNAPNTTDSLDLSHGVHTSSAGTLA\nTDRSLNTGVTRASRLENGSDTSSKSLSMGNSTHTSMTYTEKSEVSSSIHPRPETSAPGAE\nTTLTSTPGNRAISLTLPFSSIPVEEVISTGITSGPDINSAPMTHSPITPPTIVWTSTGTI\nEQSTQPLHAVSSEKVSVQTQSTPYVNSVAVSASPTHENSVSSGSSTSSPYSSASLESLDS\nTISRRNAITSWLWDLTTSLPTTTWPSTSLSEALSSGHSGVSNPSSTTTEFPLFSAASTSA\nAKQRNPETETHGPQNTAASTLNTDASSVTGLSETPVGASISSEVPLPMAITSRSDVSGLT\nSESTANPSLGTASSAGTKLTRTISLPTSESLVSFRMNKDPWTVSIPLGSHPTTNTETSIP\nVNSAGPPGLSTVASDVIDTPSDGAESIPTVSFSPSPDTEVTTISHFPEKTTHSFRTISSL\nTHELTSRVTPIPGDWMSSAMSTKPTGASPSITLGERRTITSAAPTTSPIVLTASFTETST\nVSLDNETTVKTSDILDARKTNELPSDSSSSSDLINTSIASSTMDVTKTASISPTSISGMT\nASSSPSLFSSDRPQVPTSTTETNTATSPSVSSNTYSLDGGSNVGGTPSTLPPFTITHPVE\nTSSALLAWSRPVRTFSTMVSTDTASGENPTSSNSVVTSVPAPGTWTSVGSTTDLPAMGFL\nKTSPAGEAHSLLASTIEPATAFTPHLSAAVVTGSSATSEASLLTTSESKAIHSSPQTPTT\nPTSGANWETSATPESLLVVTETSDTTLTSKILVTDTILFSTVSTPPSKFPSTGTLSGASF\nPTLLPDTPAIPLTATEPTSSLATSFDSTPLVTIASDSLGTVPETTLTMSETSNGDALVLK\nTVSNPDRSIPGITIQGVTESPLHPSSTSPSKIVAPRNTTYEGSITVALSTLPAGTTGSLV\nFSQSSENSETTALVDSSAGLERASVMPLTTGSQGMASSGGIRSGSTHSTGTKTFSSLPLT\nMNPGEVTAMSEITTNRLTATQSTAPKGIPVKPTSAESGLLTPVSASSSPSKAFASLTTAP\nPTWGIPQSTLTFEFSEVPSLDTKSASLPTPGQSLNTIPDSDASTASSSLSKSPEKNPRAR\nMMTSTKAISASSFQSTGFTETPEGSASPSMAGHEPRVPTSGTGDPRYASESMSYPDPSKA\nSSAMTSTSLASKLTTLFSTGQAARSGSSSSPISLSTEKETSFLSPTASTSRKTSLFLGPS\nMARQPNILVHLQTSALTLSPTSTLNMSQEEPPELTSSQTIAEEEGTTAETQTLTFTPSET\nPTSLLPVSSPTEPTARRKSSPETWASSISVPAKTSLVETTDGTLVTTIKMSSQAAQGNST\nWPAPAEETGSSPAGTSPGSPEMSTTLKIMSSKEPSISPEIRSTVRNSPWKTPETTVPMET\nTVEPVTLQSTALGSGSTSISHLPTGTTSPTKSPTENMLATERVSLSPSPPEAWTNLYSGT\nPGGTRQSLATMSSVSLESPTARSITGTGQQSSPELVSKTTGMEFSMWHGSTGGTTGDTHV\nSLSTSSNILEDPVTSPNSVSSLTDKSKHKTETWVSTTAIPSTVLNNKIMAAEQQTSRSVD\nEAYSSTSSWSDQTSGSDITLGASPDVTNTLYITSTAQTTSLVSLPSGDQGITSLTNPSGG\nKTSSASSVTSPSIGLETLRANVSAVKSDIAPTAGHLSQTSSPAEVSILDVTTAPTPGIST\nTITTMGTNSISTTTPNPEVGMSTMDSTPATERRTTSTEHPSTWSSTAASDSWTVTDMTSN\nLKVARSPGTISTMHTTSFLASSTELDSMSTPHGRITVIGTSLVTPSSDASAVKTETSTSE\nRTLSPSDTTASTPISTFSRVQRMSISVPDILSTSWTPSSTEAEDVPVSMVSTDHASTKTD\nPNTPLSTFLFDSLSTLDWDTGRSLSSATATTSAPQGATTPQELTLETMISPATSQLPFSI\nGHITSAVTPAAMARSSGVTFSRPDPTSKKAEQTSTQLPTTTSAHPGQVPRSAATTLDVIP\nHTAKTPDATFQRQGQTALTTEARATSDSWNEKEKSTPSAPWITEMMNSVSEDTIKEVTSS\nSSVLRTLNTLDINLESGTTSSPSWKSSPYERIAPSESTTDKEAIHPSTNTVETTGWVTSS\nEHASHSTIPAHSASSKLTSPVVTTSTREQAIVSMSTTTWPESTRARTEPNSFLTIELRDV\nSPYMDTSSTTQTSIISSPGSTAITKGPRTEITSSKRISSSFLAQSMRSSDSPSEAITRLS\nNFPAMTESGGMILAMQTSPPGATSLSAPTLDTSATASWTGTPLATTQRFTYSEKTTLFSK\nGPEDTSQPSPPSVEETSSSSSLVPIHATTSPSNILLTSQGHSPSSTPPVTSVFLSETSGL\nGKTTDMSRISLEPGTSLPPNLSSTAGEALSTYEASRDTKAIHHSADTAVTNMEATSSEYS\nPIPGHTKPSKATSPLVTSHIMGDITSSTSVFGSSETTEIETVSSVNQGLQERSTSQVASS\nATETSTVITHVSSGDATTHVTKTQATFSSGTSISSPHQFITSTNTFTDVSTNPSTSLIMT\nESSGVTITTQTGPTGAATQGPYLLDTSTMPYLTETPLAVTPDFMQSEKTTLISKGPKDVS\nWTSPPSVAETSYPSSLTPFLVTTIPPATSTLQGQHTSSPVSATSVLTSGLVKTTDMLNTS\nMEPVTNSPQNLNNPSNEILATLAATTDIETIHPSINKAVTNMGTASSAHVLHSTLPVSSE\nPSTATSPMVPASSMGDALASISIPGSETTDIEGEPTSSLTAGRKENSTLQEMNSTTESNI\nILSNVSVGAITEATKMEVPSFDATFIPTPAQSTKFPDIFSVASSRLSNSPPMTISTHMTT\nTQTGSSGATSKIPLALDTSTLETSAGTPSVVTEGFAHSKITTAMNNDVKDVSQTNPPFQD\nEASSPSSQAPVLVTTLPSSVAFTPQWHSTSSPVSMSSVLTSSLVKTAGKVDTSLETVTSS\nPQSMSNTLDDISVTSAATTDIETTHPSINTVVTNVGTTGSAFESHSTVSAYPEPSKVTSP\nNVTTSTMEDTTISRSIPKSSKTTRTETETTSSLTPKLRETSISQEITSSTETSTVPYKEL\nTGATTEVSRTDVTSSSSTSFPGPDQSTVSLDISTETNTRLSTSPIMTESAEITITTQTGP\nHGATSQDTFTMDPSNTTPQAGIHSAMTHGFSQLDVTTLMSRIPQDVSWTSPPSVDKTSSP\nSSFLSSPAMTTPSLISSTLPEDKLSSPMTSLLTSGLVKITDILRTRLEPVTSSLPNFSST\nSDKILATSKDSKDTKEIFPSINTEETNVKANNSGHESHSPALADSETPKATTQMVITTTV\nGDPAPSTSMPVHGSSETTNIKREPTYFLTPRLRETSTSQESSFPTDTSFLLSKVPTGTIT\nEVSSTGVNSSSKISTPDHDKSTVPPDTFTGEIPRVFTSSIKTKSAEMTITTQASPPESAS\nHSTLPLDTSTTLSQGGTHSTVTQGFPYSEVTTLMGMGPGNVSWMTTPPVEETSSVSSLMS\nSPAMTSPSPVSSTSPQSIPSSPLPVTALPTSVLVTTTDVLGTTSPESVTSSPPNLSSITH\nERPATYKDTAHTEAAMHHSTNTAVTNVGTSGSGHKSQSSVLADSETSKATPLMSTTSTLG\nDTSVSTSTPNISQTNQIQTEPTASLSPRLRESSTSEKTSSTTETNTAFSYVPTGAITQAS\nRTEISSSRTSISDLDRPTIAPDISTGMITRLFTSPIMTKSAEMTVTTQTTTPGATSQGIL\nPWDTSTTLFQGGTHSTVSQGFPHSEITTLRSRTPGDVSWMTTPPVEETSSGFSLMSPSMT\nSPSPVSSTSPESIPSSPLPVTALLTSVLVTTTNVLGTTSPEPVTSSPPNLSSPTQERLTT\nYKDTAHTEAMHASMHTNTAVANVGTSISGHESQSSVPADSHTSKATSPMGITFAMGDTSV\nSTSTPAFFETRIQTESTSSLIPGLRDTRTSEEINTVTETSTVLSEVPTTTTTEVSRTEVI\nTSSRTTISGPDHSKMSPYISTETITRLSTFPFVTGSTEMAITNQTGPIGTISQATLTLDT\nSSTASWEGTHSPVTQRFPHSEETTTMSRSTKGVSWQSPPSVEETSSPSSPVPLPAITSHS\nSLYSAVSGSSPTSALPVTSLLTSGRRKTIDMLDTHSELVTSSLPSASSFSGEILTSEAST\nNTETIHFSENTAETNMGTTNSMHKLHSSVSIHSQPSGHTPPKVTGSMMEDAIVSTSTPGS\nPETKNVDRDSTSPLTPELKEDSTALVMNSTTESNTVFSSVSLDAATEVSRAEVTYYDPTF\nMPASAQSTKSPDISPEASSSHSNSPPLTISTHKTIATQTGPSGVTSLGQLTLDTSTIATS\nAGTPSARTQDFVDSETTSVMNNDLNDVLKTSPFSAEEANSLSSQAPLLVTTSPSPVTSTL\nQEHSTSSLVSVTSVPTPTLAKITDMDTNLEPVTRSPQNLRNTLATSEATTDTHTMHPSIN\nTAVANVGTTSSPNEFYFTVSPDSDPYKATSAVVITSTSGDSIVSTSMPRSSAMKKIESET\nTFSLIFRLRETSTSQKIGSSSDTSTVFDKAFTAATTEVSRTELTSSSRTSIQGTEKPTMS\nPDTSTRSVTMLSTFAGLTKSEERTIATQTGPHRATSQGTLTWDTSITTSQAGTHSAMTHG\nFSQLDLSTLTSRVPEYISGTSPPSVEKTSSSSSLLSLPAITSPSPVPTTLPESRPSSPVH\nLTSLPTSGLVKTTDMLASVASLPPNLGSTSHKIPTTSEDIKDTEKMYPSTNIAVTNVGTT\nTSEKESYSSVPAYSEPPKVTSPMVTSFNIRDTIVSTSMPGSSEITRIEMESTFSLAHGLK\nGTSTSQDPIVSTEKSAVLHKLTTGATETSRTEVASSRRTSIPGPDHSTESPDISTEVIPS\nLPISLGITESSNMTIITRTGPPLGSTSQGTFTLDTPTTSSRAGTHSMATQEFPHSEMTTV\nMNKDPEILSWTIPPSIEKTSFSSSLMPSPAMTSPPVSSTLPKTIHTTPSPMTSLLTPSLV\nMTTDTLGTSPEPTTSSPPNLSSTSHEILTTDEDTTAIEAMHPSTSTAATNVETTSSGHGS\nQSSVLADSEKTKATAPMDTTSTMGHTTVSTSMSVSSETTKIKRESTYSLTPGLRETSISQ\nNASFSTDTSIVLSEVPTGTTAEVSRTEVTSSGRTSIPGPSQSTVLPEISTRTMTRLFASP\nTMTESAEMTIPTQTGPSGSTSQDTLTLDTSTTKSQAKTHSTLTQRFPHSEMTTLMSRGPG\nDMSWQSSPSLENPSSLPSLLSLPATTSPPPISSTLPVTISSSPLPVTSLLTSSPVTTTDM\nLHTSPELVTSSPPKLSHTSDERLTTGKDTTNTEAVHPSTNTAASNVEIPSSGHESPSSAL\nADSETSKATSPMFITSTQEDTTVAISTPHFLETSRIQKESISSLSPKLRETGSSVETSSA\nIETSAVLSEVSIGATTEISRTEVTSSSRTSISGSAESTMLPEISTTRKIIKFPTSPILAE\nSSEMTIKTQTSPPGSTSESTFTLDTSTTPSLVITHSTMTQRLPHSEITTLVSRGAGDVPR\nPSSLPVEETSPPSSQLSLSAMISPSPVSSTLPASSHSSSASVTSLLTPGQVKTTEVLDAS\nAEPETSSPPSLSSTSVEILATSEVTTDTEKIHPFSNTAVTKVGTSSSGHESPSSVLPDSE\nTTKATSAMGTISIMGDTSVSTLTPALSNTRKIQSEPASSLTTRLRETSTSEETSLATEAN\nTVLSKVSTGATTEVSRTEAISFSRTSMSGPEQSTMSQDISIGTIPRISASSVLTESAKMT\nITTQTGPSESTLESTLNLNTATTPSWVETHSIVIQGFPHPEMTTSMGRGPGGVSWPSPPF\nVKETSPPSSPLSLPAVTSPHPVSTTFLAHIPPSPLPVTSLLTSGPATTTDILGTSTEPGT\nSSSSSLSTTSHERLTTYKDTAHTEAVHPSTNTGGTNVATTSSGYKSQSSVLADSSPMCTT\nSTMGDTSVLTSTPAFLETRRIQTELASSLTPGLRESSGSEGTSSGTKMSTVLSKVPTGAT\nTEISKEDVTSIPGPAQSTISPDISTRTVSWFSTSPVMTESAEITMNTHTSPLGATTQGTS\nTLDTSSTTSLTMTHSTISQGFSHSQMSTLMRRGPEDVSWMSPPLLEKTRPSFSLMSSPAT\nTSPSPVSSTLPESISSSPLPVTSLLTSGLAKTTDMLHKSSEPVTNSPANLSSTSVEILAT\nSEVTTDTEKTHPSSNRTVTDVGTSSSGHESTSFVLADSQTSKVTSPMVITSTMEDTSVST\nSTPGFFETSRIQTEPTSSLTLGLRKTSSSEGTSLATEMSTVLSGVPTGATAEVSRTEVTS\nSSRTSISGFAQLTVSPETSTETITRLPTSSIMTESAEMMIKTQTDPPGSTPESTHTVDIS\nTTPNWVETHSTVTQRFSHSEMTTLVSRSPGDMLWPSQSSVEETSSASSLLSLPATTSPSP\nVSSTLVEDFPSASLPVTSLLNPGLVITTDRMGISREPGTSSTSNLSSTSHERLTTLEDTV\nDTEDMQPSTHTAVTNVRTSISGHESQSSVLSDSETPKATSPMGTTYTMGETSVSISTSDF\nFETSRIQIEPTSSLTSGLRETSSSERISSATEGSTVLSEVPSGATTEVSRTEVISSRGTS\nMSGPDQFTISPDISTEAITRLSTSPIMTESAESAITIETGSPGATSEGTLTLDTSTTTFW\nSGTHSTASPGFSHSEMTTLMSRTPGDVPWPSLPSVEEASSVSSSLSSPAMTSTSFFSTLP\nESISSSPHPVTALLTLGPVKTTDMLRTSSEPETSSPPNLSSTSAEILATSEVTKDREKIH\nPSSNTPVVNVGTVIYKHLSPSSVLADLVTTKPTSPMATTSTLGNTSVSTSTPAFPETMMT\nQPTSSLTSGLREISTSQETSSATERSASLSGMPTGATTKVSRTEALSLGRTSTPGPAQST\nISPEISTETITRISTPLTTTGSAEMTITPKTGHSGASSQGTFTLDTSSRASWPGTHSAAT\nHRSPHSGMTTPMSRGPEDVSWPSRPSVEKTSPPSSLVSLSAVTSPSPLYSTPSESSHSSP\nLRVTSLFTPVMMKTTDMLDTSLEPVTTSPPSMNITSDESLATSKATMETEAIQLSENTAV\nTQMGTISARQEFYSSYPGLPEPSKVTSPVVTSSTIKDIVSTTIPASSEITRIEMESTSTL\nTPTPRETSTSQEIHSATKPSTVPYKALTSATIEDSMTQVMSSSRGPSPDQSTMSQDISTE\nVITRLSTSPIKTESTEMTITTQTGSPGATSRGTLTLDTSTTFMSGTHSTASQGFSHSQMT\nALMSRTPGDVPWLSHPSVEEASSASFSLSSPVMTSSSPVSSTLPDSIHSSSLPVTSLLTS\nGLVKTTELLGTSSEPETSSPPNLSSTSAEILAITEVTTDTEKLEMTNVVTSGYTHESPSS\nVLADSVTTKATSSMGITYPTGDTNVLTSTPAFSDTSRIQTKSKLSLTPGLMETSISEETS\nSATEKSTVLSSVPTGATTEVSRTEAISSSRTSIPGPAQSTMSSDTSMETITRISTPLTRK\nESTDMAITPKTGPSGATSQGTFTLDSSSTASWPGTHSATTQRFPQSVVTTPMSRGPEDVS\nWPSPLSVEKNSPPSSLVSSSSVTSPSPLYSTPSGSSHSSPVPVTSLFTSIMMKATDMLDA\nSLEPETTSAPNMNITSDESLAASKATTETEAIHVFENTAASHVETTSATEELYSSSPGFS\nEPTKVISPVVTSSSIRDNMVSTTMPGSSGITRIEIESMSSLTPGLRETRTSQDITSSTET\nSTVLYKMPSGATPEVSRTEVMPSSRTSIPGPAQSTMSLDISDEVVTRLSTSPIMTESAEI\nTITTQTGYSLATSQVTLPLGTSMTFLSGTHSTMSQGLSHSEMTNLMSRGPESLSWTSPRF\nVETTRSSSSLTSLPLTTSLSPVSSTLLDSSPSSPLPVTSLILPGLVKTTEVLDTSSEPKT\nSSSPNLSSTSVEIPATSEIMTDTEKIHPSSNTAVAKVRTSSSVHESHSSVLADSETTITI\nPSMGITSAVDDTTVFTSNPAFSETRRIPTEPTFSLTPGFRETSTSEETTSITETSAVLYG\nVPTSATTEVSMTEIMSSNRIHIPDSDQSTMSPDIITEVITRLSSSSMMSESTQMTITTQK\nSSPGATAQSTLTLATTTAPLARTHSTVPPRFLHSEMTTLMSRSPENPSWKSSLFVEKTSS\nSSSLLSLPVTTSPSVSSTLPQSIPSSSFSVTSLLTPGMVKTTDTSTEPGTSLSPNLSGTS\nVEILAASEVTTDTEKIHPSSSMAVTNVGTTSSGHELYSSVSIHSEPSKATYPVGTPSSMA\nETSISTSMPANFETTGFEAEPFSHLTSGFRKTNMSLDTSSVTPTNTPSSPGSTHLLQSSK\nTDFTSSAKTSSPDWPPASQYTEIPVDIITPFNASPSITESTGITSFPESRFTMSVTESTH\nHLSTDLLPSAETISTGTVMPSLSEAMTSFATTGVPRAISGSGSPFSRTESGPGDATLSTI\nAESLPSSTPVPFSSSTFTTTDSSTIPALHEITSSSATPYRVDTSLGTESSTTEGRLVMVS\nTLDTSSQPGRTSSSPILDTRMTESVELGTVTSAYQVPSLSTRLTRTDGIMEHITKIPNEA\nAHRGTIRPVKGPQTSTSPASPKGLHTGGTKRMETTTTALKTTTTALKTTSRATLTTSVYT\nPTLGTLTPLNASMQMASTIPTEMMITTPYVFPDVPETTSSLATSLGAETSTALPRTTPSV\nFNRESETTASLVSRSGAERSPVIQTLDVSSSEPDTTASWVIHPAETIPTVSKTTPNFFHS\nELDTVSSTATSHGADVSSAIPTNISPSELDALTPLVTISGTDTSTTFPTLTKSPHETETR\nTTWLTHPAETSSTIPRTIPNFSHHESDATPSIATSPGAETSSAIPIMTVSPGAEDLVTSQ\nVTSSGTDRNMTIPTLTLSPGEPKTIASLVTHPEAQTSSAIPTSTISPAVSRLVTSMVTSL\nAAKTSTTNRALTNSPGEPATTVSLVTHPAQTSPTVPWTTSIFFHSKSDTTPSMTTSHGAE\nSSSAVPTPTVSTEVPGVVTPLVTSSRAVISTTIPILTLSPGEPETTPSMATSHGEEASSA\nIPTPTVSPGVPGVVTSLVTSSRAVTSTTIPILTFSLGEPETTPSMATSHGTEAGSAVPTV\nLPEVPGMVTSLVASSRAVTSTTLPTLTLSPGEPETTPSMATSHGAEASSTVPTVSPEVPG\nVVTSLVTSSSGVNSTSIPTLILSPGELETTPSMATSHGAEASSAVPTPTVSPGVSGVVTP\nLVTSSRAVTSTTIPILTLSSSEPETTPSMATSHGVEASSAVLTVSPEVPGMVTSLVTSSR\nAVTSTTIPTLTISSDEPETTTSLVTHSEAKMISAIPTLAVSPTVQGLVTSLVTSSGSETS\nAFSNLTVASSQPETIDSWVAHPGTEASSVVPTLTVSTGEPFTNISLVTHPAESSSTLPRT\nTSRFSHSELDTMPSTVTSPEAESSSAISTTISPGIPGVLTSLVTSSGRDISATFPTVPES\nPHESEATASWVTHPAVTSTTVPRTTPNYSHSEPDTTPSIATSPGAEATSDFPTITVSPDV\nPDMVTSQVTSSGTDTSITIPTLTLSSGEPETTTSFITYSETHTSSAIPTLPVSPGASKML\nTSLVISSGTDSTTTFPTLTETPYEPETTAIQLIHPAETNTMVPRTTPKFSHSKSDTTLPV\nAITSPGPEASSAVSTTTISPDMSDLVTSLVPSSGTDTSTTFPTLSETPYEPETTATWLTH\nPAETSTTVSGTIPNFSHRGSDTAPSMVTSPGVDTRSGVPTTTIPPSIPGVVTSQVTSSAT\nDTSTAIPTLTPSPGEPETTASSATHPGTQTGFTVPIRTVPSSEPDTMASWVTHPPQTSTP\nVSRTTSSFSHSSPDATPVMATSPRTEASSAVLTTISPGAPEMVTSQITSSGAATSTTVPT\nLTHSPGMPETTALLSTHPRTETSKTFPASTVFPQVSETTASLTIRPGAETSTALPTQTTS\nSLFTLLVTGTSRVDLSPTASPGVSAKTAPLSTHPGTETSTMIPTSTLSLGLLETTGLLAT\nSSSAETSTSTLTLTVSPAVSGLSSASITTDKPQTVTSWNTETSPSVTSVGPPEFSRTVTG\nTTMTLIPSEMPTPPKTSHGEGVSPTTILRTTMVEATNLATTGSSPTVAKTTTTFNTLAGS\nLFTPLTTPGMSTLASESVTSRTSYNHRSWISTTSSYNRRYWTPATSTPVTSTFSPGISTS\nSIPSSTAATVPFMVPFTLNFTITNLQYEEDMRHPGSRKFNATERELQGLLKPLFRNSSLE\nYLYSGCRLASLRPEKDSSATAVDAICTHRPDPEDLGLDRERLYWELSNLTNGIQELGPYT\nLDRNSLYVNGFTHRSSMPTTSTPGTSTVDVGTSGTPSSSPSPTTAGPLLMPFTLNFTITN\nLQYEEDMRRTGSRKFNTMESVLQGLLKPLFKNTSVGPLYSGCRLTLLRPEKDGAATGVDA\nICTHRLDPKSPGLNREQLYWELSKLTNDIEELGPYTLDRNSLYVNGFTHQSSVSTTSTPG\nTSTVDLRTSGTPSSLSSPTIMAAGPLLVPFTLNFTITNLQYGEDMGHPGSRKFNTTERVL\nQGLLGPIFKNTSVGPLYSGCRLTSLRSEKDGAATGVDAICIHHLDPKSPGLNRERLYWEL\nSQLTNGIKELGPYTLDRNSLYVNGFTHRTSVPTSSTPGTSTVDLGTSGTPFSLPSPATAG\nPLLVLFTLNFTITNLKYEEDMHRPGSRKFNTTERVLQTLLGPMFKNTSVGLLYSGCRLTL\nLRSEKDGAATGVDAICTHRLDPKSPGVDREQLYWELSQLTNGIKELGPYTLDRNSLYVNG\nFTHWIPVPTSSTPGTSTVDLGSGTPSSLPSPTTAGPLLVPFTLNFTITNLKYEEDMHCPG\nSRKFNTTERVLQSLLGPMFKNTSVGPLYSGCRLTLLRSEKDGAATGVDAICTHRLDPKSP\nGVDREQLYWELSQLTNGIKELGPYTLDRNSLYVNGFTHQTSAPNTSTPGTSTVDLGTSGT\nPSSLPSPTSAGPLLVPFTLNFTITNLQYEEDMHHPGSRKFNTTERVLQGLLGPMFKNTSV\nGLLYSGCRLTLLRPEKNGAATGMDAICSHRLDPKSPGLNREQLYWELSQLTHGIKELGPY\nTLDRNSLYVNGFTHRSSVAPTSTPGTSTVDLGTSGTPSSLPSPTTAVPLLVPFTLNFTIT\nNLQYGEDMRHPGSRKFNTTERVLQGLLGPLFKNSSVGPLYSGCRLISLRSEKDGAATGVD\nAICTHHLNPQSPGLDREQLYWQLSQMTNGIKELGPYTLDRNSLYVNGFTHRSSGLTTSTP\nWTSTVDLGTSGTPSPVPSPTTTGPLLVPFTLNFTITNLQYEENMGHPGSRKFNITESVLQ\nGLLKPLFKSTSVGPLYSGCRLTLLRPEKDGVATRVDAICTHRPDPKIPGLDRQQLYWELS\nQLTHSITELGPYTLDRDSLYVNGFTQRSSVPTTSTPGTFTVQPETSETPSSLPGPTATGP\nVLLPFTLNFTITNLQYEEDMRRPGSRKFNTTERVLQGLLMPLFKNTSVSSLYSGCRLTLL\nRPEKDGAATRVDAVCTHRPDPKSPGLDRERLYWKLSQLTHGITELGPYTLDRHSLYVNGF\nTHQSSMTTTRTPDTSTMHLATSRTPASLSGPMTASPLLVLFTINFTITNLRYEENMHHPG\nSRKFNTTERVLQGLLRPVFKNTSVGPLYSGCRLTLLRPKKDGAATKVDAICTYRPDPKSP\nGLDREQLYWELSQLTHSITELGPYTLDRDSLYVNGFTQRSSVPTTSIPGTPTVDLGTSGT\nPVSKPGPSAASPLLVLFTLNFTITNLRYEENMQHPGSRKFNTTERVLQGLLRSLFKSTSV\nGPLYSGCRLTLLRPEKDGTATGVDAICTHHPDPKSPRLDREQLYWELSQLTHNITELGPY\nALDNDSLFVNGFTHRSSVSTTSTPGTPTVYLGASKTPASIFGPSAASHLLILFTLNFTIT\nNLRYEENMWPGSRKFNTTERVLQGLLRPLFKNTSVGPLYSGCRLTLLRPEKDGEATGVDA\nICTHRPDPTGPGLDREQLYLELSQLTHSITELGPYTLDRDSLYVNGFTHRSSVPTTSTGV\nVSEEPFTLNFTINNLRYMADMGQPGSLKFNITDNVMQHLLSPLFQRSSLGARYTGCRVIA\nLRSVKNGAETRVDLLCTYLQPLSGPGLPIKQVFHELSQQTHGITRLGPYSLDKDSLYLNG\nYNEPGPDEPPTTPKPATTFLPPLSEATTAMGYHLKTLTLNFTISNLQYSPDMGKGSATFN\nSTEGVLQHLLRPLFQKSSMGPFYLGCQLISLRPEKDGAATGVDTTCTYHPDPVGPGLDIQ\nQLYWELSQLTHGVTQLGFYVLDRDSLFINGYAPQNLSIRGEYQINFHIVNWNLSNPDPTS\nSEYITLLRDIQDKVTTLYKGSQLHDTFRFCLVTNLTMDSVLVTVKALFSSNLDPSLVEQV\nFLDKTLNASFHWLGSTYQLVDIHVTEMESSVYQPTSSSSTQHFYLNFTITNLPYSQDKAQ\nPGTTNYQRNKRNIEDALNQLFRNSSIKSYFSDCQVSTFRSVPNRHHTGVDSLCNFSPLAR\nRVDRVAIYEEFLRMTRNGTQLQNFTLDRSSVLVDGYSPNRNEPLTGNSDLPFWAVILIGL\nAGLLGVITCLICGVLVTTRRRKKEGEYNVQQQCPGYYQSHLDLEDLQ\n'
    _, embed = encode_sequence_bert(sequence)
    print(embed.shape)